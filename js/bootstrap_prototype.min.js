/* ===================================================
 * bootstrap-transition.js v2.3.0
 * http://twitter.github.com/bootstrap/javascript.html#transitions
 * ===================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */
/*

Modified for use with PrototypeJS

http://github.com/jwestbrook/bootstrap-prototype


*/
var BootStrap={transitionendevent:null,handleeffects:null},transEndEventNames=$H({WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"}),el=new Element("bootstrap");transEndEventNames.each(function(a){void 0!==el.style[a.key]&&(BootStrap.transitionendevent=a.value,BootStrap.handleeffects="css")});
null===BootStrap.handleeffects&&("undefined"!==typeof Scriptaculous&&"undefined"!==typeof Effect)&&(BootStrap.handleeffects="effect");
BootStrap.Alert=Class.create({initialize:function(a){$(a).observe("click",this.close)},close:function(){function a(){d.fire("bootstrap:closed");d.remove()}var b=$(this),c=b.readAttribute("data-target"),d;c||(c=(c=b.href)&&c.replace(/.*(?=#[^\s]*$)/,"").replace("#",""));void 0!=c&&0<c.length?d=$(c):"";void 0!=d&&d.length||(d=b.hasClassName("alert")?b:b.up());d.fire("bootstrap:close");"css"===BootStrap.handleeffects&&d.hasClassName("fade")?(d.observe(BootStrap.transitionendevent,function(){a()}),d.removeClassName("in")):
"effect"===BootStrap.handleeffects&&d.hasClassName("fade")&&new Effect.Fade(d,{duration:0.3,from:1*d.getOpacity(),afterFinish:function(){d.removeClassName("in");a()}})}});
BootStrap.Button=Class.create({initialize:function(a,b){this.$element=$(a);"object"==typeof b?(this.options=b,this.options.loadingText="undefined"!=typeof this.options.loadingText?b.loadingText:""):"undefined"!=typeof b&&"toggle"==b?this.toggle():"undefined"!=typeof b&&this.setState(b)},setState:function(a){var b=this.$element,c=b.gethtml5data(),d="input"==b.readAttribute("type")?"value":"innerHTML";a+="Text";c.resetText||b.sethtml5data("resetText",b[d]);b[d]=c[a]||this.options[a];setTimeout(function(){"loadingText"==
a?b.addClassName("disabled").writeAttribute("disabled",!0):b.removeClassName("disabled").writeAttribute("disabled",!1)},0)},toggle:function(){var a=this.$element.up('[data-toggle="buttons-radio"]');a&&a.select(".active").invoke("removeClassName","active");this.$element.toggleClassName("active")}});var toggle="[data-toggle=dropdown]";
BootStrap.Dropdown=Class.create({initialize:function(a){var b=$(a).on("click",this.toggle);$$("html")[0].on("click",function(){b.up().removeClassName("open")})},toggle:function(a){var b=$(this),c,d;b.hasClassName("disabled")||"disabled"==b.readAttribute("disabled")||(c=getParent(b),d=c.hasClassName("open"),clearMenus(),d||c.toggleClassName("open"),b.focus(),a.stop())},keydown:function(a){var b,c,d,e;if(/(38|40|27)/.test(a.keyCode)&&(b=$(this),a.preventDefault(),a.stopPropagation(),!(b.hasClassName("disabled")||
"disabled"==b.readAttribute("disabled")))){c=getParent(b);d=c.hasClassName("open");if(!d||d&&a.keyCode==Event.KEY_ESC)return a.which==Event.KEY_ESC&&c.select(toggle)[0].focus(),b.click();b=c.select("[role=menu] li:not(.divider) a");b.length&&(e=-1,b.each(function(a,b){a.match(":focus")?e=b:""}),a.keyCode==Event.KEY_UP&&0<e&&e--,a.keyCode==Event.KEY_DOWN&&e<b.length-1&&e++,~e||(e=0),b[e].focus())}}});function clearMenus(){$$(toggle).each(function(a){getParent(a).removeClassName("open")})}
function getParent(a){var b=a.readAttribute("data-target");b||(b=(b=a.readAttribute("href"))&&/#/.test(b)&&b.replace(/.*(?=#[^\s]*$)/,"")&&"#"!=b);b=b&&$$(b);if(!b||!b.length)b=a.up();return b}
BootStrap.Modal=Class.create({initialize:function(a,b){this.$element=$(a);this.options=b;this.options.backdrop=void 0!=this.options.backdrop?b.backdrop:!0;this.options.keyboard=void 0!=this.options.keyboard?b.keyboard:!0;this.options.show=void 0!=this.options.show?b.show:!0;this.options.show&&this.show();$$("[data-dismiss='modal']").invoke("observe","click",function(){this.hide()}.bind(this));this.options.remote&&this.$element.select(".modal-body")&&new Ajax.Updater(this.$element.select(".modal-body")[0],
this.options.remote)},toggle:function(){return this[!this.isShown?"show":"hide"]()},show:function(){var a=this;this.$element.setStyle({display:"block"});this.isShown||(this.isShown=!0,this.escape(),this.backdrop(function(){var b=("css"==BootStrap.handleeffects||"effect"==BootStrap.handleeffects&&"undefined"!==typeof Effect&&"undefined"!==typeof Effect.Fade)&&a.$element.hasClassName("fade");a.$element.up().length||$$("body")[0].insert(a.$element);a.$element.setStyle({display:"block"});b&&"css"==BootStrap.handleeffects?
(a.$element.observe(BootStrap.transitionendevent,function(){a.$element.fire("bootstrap:shown")}),setTimeout(function(){a.$element.addClassName("in").writeAttribute("aria-hidden",!1)},1)):b&&"effect"==BootStrap.handleeffects?new Effect.Parallel([new Effect.Morph(a.$element,{sync:!0,style:"top:10%"}),new Effect.Opacity(a.$element,{sync:!0,from:0,to:1})],{duration:0.3,afterFinish:function(){a.$element.addClassName("in").writeAttribute("aria-hidden",!1);a.$element.fire("bootstrap:shown")}}):a.$element.addClassName("in").writeAttribute("aria-hidden",
!1).fire("bootstrap:shown");a.enforceFocus()}))},hide:function(){this.isShown&&(this.isShown=!1,this.escape(),"css"==BootStrap.handleeffects&&this.$element.hasClassName("fade")?this.hideWithTransition():"effect"==BootStrap.handleeffects&&"undefined"!==typeof Effect&&"undefined"!==typeof Effect.Fade&&this.$element.hasClassName("fade")?this.hideWithTransition():(this.hideModal(),this.$element.setStyle({display:""})))},enforceFocus:function(){var a=this;$(document).on("focus",function(b){a.$element[0]!==
b.target&&!a.$element.has(b.target).length&&a.$element.focus()})},escape:function(){var a=this;if(this.isShown&&this.options.keyboard)$(document).on("keyup",function(b){b.which==Event.KEY_ESC&&a.hide()});else this.isShown||$(document).stopObserving("keyup")},hideWithTransition:function(){var a=this;"css"==BootStrap.handleeffects?(this.$element.observe(BootStrap.transitionendevent,function(){this.setStyle({display:""});this.setStyle({top:""});a.hideModal();this.stopObserving(BootStrap.transitionendevent)}),
setTimeout(function(){this.$element.removeClassName("in").writeAttribute("aria-hidden",!0)}.bind(this))):new Effect.Morph(this.$element,{duration:0.3,style:"top:-25%;",afterFinish:function(b){b.element.removeClassName("in").writeAttribute("aria-hidden",!0);b.element.setStyle({display:""});b.element.setStyle({top:""});a.hideModal()}})},hideModal:function(){this.$element.hide();this.backdrop(function(){this.removeBackdrop();this.$element.fire("bootstrap:hidden")}.bind(this))},removeBackdrop:function(){this.$backdrop.remove();
this.$backdrop=null},backdrop:function(a){var b=this,c=this.$element.hasClassName("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var d=("css"==BootStrap.handleeffects||"effect"==BootStrap.handleeffects&&"undefined"!==typeof Effect&&"undefined"!==typeof Effect.Fade)&&c;this.$backdrop=new Element("div",{"class":"modal-backdrop "+c});d&&"css"==BootStrap.handleeffects?this.$backdrop.observe(BootStrap.transitionendevent,function(){a();this.stopObserving(BootStrap.transitionendevent)}):d&&"effect"==
BootStrap.handleeffects&&this.$backdrop.setOpacity(0);this.$backdrop.observe("click",function(){"static"==b.options.backdrop?"":b.hide()});$$("body")[0].insert(this.$backdrop);d&&"effect"==BootStrap.handleeffects?new Effect.Appear(this.$backdrop,{from:0,to:0.8,duration:0.3,afterFinish:a}):a();setTimeout(function(){b.$backdrop.addClassName("in")},1)}else!this.isShown&&this.$backdrop?c&&"css"==BootStrap.handleeffects?(b.$backdrop.observe(BootStrap.transitionendevent,function(){a()}),setTimeout(function(){b.$backdrop.removeClassName("in")},
1)):c&&"effect"==BootStrap.handleeffects&&"undefined"!==typeof Effect&&"undefined"!==typeof Effect.Fade?new Effect.Fade(b.$backdrop,{duration:0.3,from:1*b.$backdrop.getOpacity(),afterFinish:function(){b.$backdrop.removeClassName("in");a()}}):(b.$backdrop.removeClassName("in"),a()):a&&a()}});
BootStrap.Tooltip=Class.create({initialize:function(a,b){this.options={animation:!0,placement:"top",selector:!1,template:(new Element("div",{"class":"tooltip"})).insert(new Element("div",{"class":"tooltip-arrow"})).insert(new Element("div",{"class":"tooltip-inner"})),trigger:"hover focus",title:"",delay:0,html:!1,container:!1};Object.extend(this.options,b);this.options.delay&&"number"==typeof this.options.delay&&(this.options.delay={show:b.delay,hide:b.delay});void 0==this.options.subclass&&this.init("tooltip",
a)},init:function(a,b){var c,d;this.type=a;this.$element=$(b);this.enabled=!0;this.options.trigger.split(" ").each(function(a){"click"==a?this.$element.observe("click",this.toggle.bind(this)):"manual"!=a&&(c="hover"==a?"mouseenter":"focus",d="hover"==a?"mouseleave":"blur",this.$element.observe(c,this.enter.bind(this)),this.$element.observe(d,this.leave.bind(this)))},this);this.options.selector?(this._options=Object.extend({},this.options),Object.extend(this._options,{trigger:"manual",selector:""})):
this.fixTitle()},enter:function(){var a=this;if(!a.options.delay||!a.options.delay.show)return a.show();clearTimeout(this.timeout);a.hoverState="in";this.timeout=setTimeout(function(){"in"==a.hoverState&&a.show()},a.options.delay.show)},leave:function(){var a=this;this.timeout&&clearTimeout(this.timeout);if(!a.options.delay||!a.options.delay.hide)return a.hide();a.hoverState="out";this.timeout=setTimeout(function(){"out"==a.hoverState&&a.hide()},a.options.delay.hide)},show:function(){var a,b,c,d,
e;if(this.hasContent()&&this.enabled){this.$element.fire("bootstrap:show");a=this.tip();this.setContent();this.options.animation&&a.addClassName("fade");d="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement;a.setStyle({top:0,left:0,display:"block"});this.options.container?this.options.container.insert(a):this.$element.insert({after:a});b=this.getPosition();c=a.offsetWidth;a=a.offsetHeight;switch(d){case "bottom":e={top:b.top+b.height,
left:b.left+b.width/2-c/2};break;case "top":e={top:b.top-a,left:b.left+b.width/2-c/2};break;case "left":e={top:b.top+b.height/2-a/2,left:b.left-c};break;case "right":e={top:b.top+b.height/2-a/2,left:b.left+b.width}}e.top+="px";e.left+="px";this.applyPlacement(e,d);this.$element.fire("bootstrap:shown")}},applyPlacement:function(a,b){var c=this.tip(),d=c.offsetWidth,e=c.offsetHeight,g,f,h;c.setStyle(a).addClassName(b).addClassName("in");a.top=1*a.top.replace("px","");a.left=1*a.left.replace("px","");
g=c.offsetWidth;f=c.offsetHeight;"top"==b&&f!=e&&(a.top=a.top+e-f,h=!0);"bottom"==b||"top"==b?(e=0,0>a.left&&(e=-2*a.left,a.left=0,a.top+="px",a.left+="px",c.setStyle(a),g=c.offsetWidth),this.replaceArrow(e-d+g,g,"left")):this.replaceArrow(f-e,f,"top");"srting"==typeof a.top&&!a.top.match(/px/)&&(a.top+="px",a.left+="px");h&&c.setStyle(a)},replaceArrow:function(a,b){this.arrow().length?this.arrow()[0].setStyle({position:a?50*(1-a/b)+"%":""}):""},setContent:function(){var a=this.tip(),b=this.getTitle();
this.options.html||(b=b.escapeHTML());a.select(".tooltip-inner")[0].update(b);a.removeClassName("fade in top bottom left right")},hide:function(){var a=this,b=this.tip();if("css"==BootStrap.handleeffects&&this.$tip.hasClassName("fade")){var c=setTimeout(function(){b.stopObserving(BootStrap.transitionendevent);b?b.remove():""},500);b.observe(BootStrap.transitionendevent,function(){clearTimeout(c);b?b.remove():"";this.stopObserving(BootStrap.transitionendevent);a.$element.fire("bootrap:hidden")});b.removeClassName("in")}else"effect"==
BootStrap.handleeffects&&this.$tip.hasClassName("fade")?new Effect.Fade(b,{duration:0.3,from:1*b.getOpacity(),afterFinish:function(){b.removeClassName("in");b.remove();a.$element.fire("bootrap:hidden")}}):(b.removeClassName("in"),b.remove(),this.$element.fire("bootrap:hidden"));return this},fixTitle:function(){var a=this.$element;if(a.readAttribute("title")||"string"!=typeof a.readAttribute("data-original-title"))a.writeAttribute("data-original-title",a.readAttribute("title")||"").writeAttribute("title",
null)},hasContent:function(){return this.getTitle()},getPosition:function(){var a=this.$element,b={};"function"==typeof a.getBoundingClientRect?Object.extend(b,a.getBoundingClientRect()):Object.extend(b,{width:a.offsetWidth,height:a.offsetHeight});return Object.extend(b,a.cumulativeOffset())},getTitle:function(){var a=this.$element,b=this.options;return a.readAttribute("data-original-title")||("function"==typeof b.title?b.title.call(a[0]):b.title)},tip:function(){return this.$tip=this.$tip||this.options.template},
arrow:function(){return this.$arrow=this.$arrow||this.tip().select(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.options=this.$element=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this.tip().hasClassName("in")?this.hide():this.show()},destroy:function(){this.hide().$element.stopObserving()}});
BootStrap.Popover=Class.create(BootStrap.Tooltip,{initialize:function($super,b,c){$super(b,{subclass:!0});Object.extend(this.options,{placement:"right",trigger:"click",content:"",template:(new Element("div",{"class":"popover"})).insert(new Element("div",{"class":"arrow"})).insert(new Element("h3",{"class":"popover-title"})).insert(new Element("div",{"class":"popover-content"}))});Object.extend(this.options,c);this.init("popover",b,this.options)},setContent:function(){var a=this.tip(),b=this.getTitle(),
c=this.getContent();a.select(".popover-title")[0].update(b);a.select(".popover-content")[0].update(c);a.removeClassName("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var a=this.$element,b=this.options;return("function"==typeof b.content?b.content.call(a[0]):b.content)||a.readAttribute("data-content")},tip:function(){this.$tip||(this.$tip=this.options.template);return this.$tip},destroy:function(){this.hide();this.$element.stopObserving(this.options.trigger)}});
BootStrap.Tab=Class.create({initialize:function(a){this.element=$(a)},show:function(){var a=this.element,b=a.up("ul:not(.dropdown-menu)"),c=a.readAttribute("data-target"),d;c||(c=(c=a.readAttribute("href"))&&c.replace(/.*(?=#[^\s]*$)/,""));a.up("li").hasClassName("active")||(d=b.select(".active:last a")[0],a.fire("bootstrap:show",d),c=$$(c)[0],this.activate(a.up("li"),b),this.activate(c,c.up(),function(){a.fire("bootstrap:shown",d)}))},activate:function(a,b,c){function d(){e.removeClassName("active").select("> .dropdown-menu > .active").invoke("removeClassName",
"active");a.addClassName("active");g?(a.offsetWidth,a.addClassName("in")):f?new Effect.Appear(a,{duration:0.3,afterFinish:function(){a.addClassName("in")}}):a.removeClassName("fade");a.up(".dropdown-menu")&&a.up("li.dropdown").addClassName("active");c&&c()}var e=b.select("> .active")[0],g=c&&"css"==BootStrap.handleeffects&&e.hasClassName("fade"),f="effect"==BootStrap.handleeffects&&"undefined"!==typeof Effect&&"undefined"!==typeof Effect.Fade;g?(e.observe(BootStrap.transitionendevent,function(a){d(a);
this.stopObserving(BootStrap.transitionendevent)}),e.removeClassName("in")):f?e.hasClassName("in")&&e.hasClassName("fade")?new Effect.Fade(e,{duration:0.3,afterFinish:function(){e.removeClassName("in");d()}}):d():(d(),e.removeClassName("in"))}});
document.observe("dom:loaded",function(){$$('.alert [data-dismiss="alert"]').each(function(a){new BootStrap.Alert(a)});$$("[data-toggle^=button]").invoke("observe","click",function(a){a=a.findElement();a.hasClassName("btn")||(a=a.up(".btn"));new BootStrap.Button(a,"toggle")});document.observe("click",clearMenus);$$(".dropdown form").invoke("observe","click",function(a){a.stop()});$$(toggle).invoke("observe","click",BootStrap.Dropdown.prototype.toggle);$$(toggle+", [role=menu]").invoke("observe","keydown",
BootStrap.Dropdown.prototype.keydown);$$("[data-toggle='modal']").invoke("observe","click",function(a){var b=this.readAttribute("data-target")||this.href&&this.href.replace(/.*(?=#[^\s]+$)/,"").replace(/#/,""),c={};void 0!=$(b)&&(b=$(b),/#/.test(this.href)||(c.remote=this.href),new BootStrap.Modal($(b),c));a.stop()});$$(".tooltip").each(function(a){new BootStrap.Tooltip(a)});$$('[data-toggle="tab"], [data-toggle="pill"]').invoke("observe","click",function(a){a.preventDefault();(new BootStrap.Tab(this)).show()})});